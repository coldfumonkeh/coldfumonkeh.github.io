---
layout: post
title: Generate QR Codes with bit.ly ColdFusion Component
slug: generate-qr-codes-with-bit-ly
date: 2010-10-14
categories:
- ColdFusion
tags:
- Adobe
- API
- CFC
- ColdFusion
status: publish
type: post
published: true
---
<p>This morning I released an updated version of my <a title="View the original post" href="http://www.mattgifford.co.uk/bitly-coldfusion-api/" target="_self">bit.ly ColdFusion CFC Wrapper</a>, which is now at version 2.0.</p>
<p>The core reason for the update was to provide the new methods now included within the official bit.ly API.</p>
<h2>What’s changed?</h2>
<p>There are four official new methods that have been added into the ColdFusion wrapper for the API, which are:</p>
<ul>
<li>referers</li>
<li>countries</li>
<li>clicksByMinute</li>
<li>clicksByDay</li>
</ul>
<p>These methods are a great way to provide a little analytical data for any bit.ly generated URLs. Superb stuff and incredibly easy to obtain, especially though the CFC.</p>
<h2>QR Codes</h2>
<p>A significant addition to the bit.ly service is the ability to generate <a title="Find out more about QR Codes on Wikipedia" href="http://en.wikipedia.org/wiki/QR_Code" target="_blank">Quick Response (QR) codes</a>, or data matrix barcodes - those awesome little 2D barcodes that can be read by most smartphones, scanners etc.. a perfect way of storing and publishing text, information, or most commonly, a URL.</p>
<p><a href="/assets/uploads/2010/10/IronManQRCode.gif"><img title="Iron Man QR Code" src="/assets/uploads/2010/10/IronManQRCode-202x300.gif" alt="Iron Man QR Code" /></a> It's not new technology, it's not really a new idea, but with the constant release of smartphones and devices capable of reading them (and so much more) it's becoming more common-place within today's society.</p>
<p>Naturally, as a format widely accessible to not only providers but also consumers, it's become a '2.0' option of delivery for marketing campaigns and advertising - an ideal, enigmatic way to promote your services or products.</p>
<p><a href="/assets/uploads/2010/10/LostQRCode.gif"><img title="Lost QR Code" src="/assets/uploads/2010/10/LostQRCode-221x300.gif" alt="Lost QR Code" /></a></p>
<p>As <a title="View the original post on Mashable.com" href="http://mashable.com/2010/09/30/goo-gl-url-shortener/" target="_blank">reported in Mashable</a>, Google recently released their URL shortening service goo.gl, which by all accounts included QR Code generation from the start. As such, it wasn't a surprise to see bit.ly step up and include this support in their services to ensure that their users weren't missing out on the same capabilities.</p>
<h3>Grabbing a QR Code</h3>
<p>Although not an official method included within the bit.ly API, ColdFusion makes it incredibly easy to obtain and retrieve this information, it has been included within the bit.ly CFC.</p>
<p>Here's how easy it is to generate the QR Code using the bit.ly CFC:</p>
<pre name="code" class="xml">
&lt;!---
	Instantiate the bit.ly object.
---&gt;
&lt;cfset objBitly = createObject('component',
		'com.coldfumonkeh.bitly.bitly')
		.init(
			username	=	'&lt; your account username &gt;',
			apikey		=	'&lt; your bit.ly api key &gt;',
			parse		=	true
		) /&gt;


&lt;!---
	The generateQRCode() method returns binary data
	(the byte array) of the generated image.
---&gt;
&lt;cfset qrResponse = objBitly.generateQRCode(
						shortURL	= 'http://bit.ly/d6sCNC'
					) /&gt;

&lt;!---
	Dump out the binary response from the
	initial call (just to see what was returned).
---&gt;
&lt;cfdump var="#qrResponse#"
		label="QRCode binary response" /&gt;

&lt;!---
	Write the binary data as an image and display
	directly into the browser. Thanks, ColdFusion.
---&gt;
&lt;cfimage action="writeToBrowser"
		 source="#qrResponse#" /&gt;
</pre>
<p>The returned response from the cfdump of the binary data is shown below:</p>
<p><img src="/assets/uploads/2010/10/QRCode_BinaryDump.gif" alt="QR Code Binary Dump" title="QR Code Binary Dump" /></p>
<p>And the image generated by passing the binary data into the cfimage tag can be seen here (in this case, this image contains a link to http://www.mattgifford.co.uk):</p>
<p><img src="/assets/uploads/2010/10/mattgiffordQRCode.gif" alt="mattgifford.co.uk QR Code" title="mattgifford.co.uk QR Code" /></p>
<h3>What's Happening Under The Hood?</h3>
<p>Obtaining the generated QR Code is incredibly easy. The guys at bit.ly have engineered their systems to allow anyone to obtain a QR Code by appending the string '.qrcode' to the end of any bit.ly shortened URL, for example: <strong>http://bit.ly/d6sCNC.qrcode</strong></p>
<p>Running directly in the browser, you get the generated image returned, which you can then copy / save to suit your needs. The actual call within the CFC Wrapper is very straightforward:</p>
<pre name="code" class="xml">

&lt;cffunction name="generateQRCode"
			access="public"
			output="false"
			hint="I take a bit.ly generated URL, and return the
			binary data of the generated QR Code image."&gt;

	&lt;cfargument name="shortURL"
				required="true" type="string"
				hint="I am a short URL that you wish to
						create a QR Code for." /&gt;
		&lt;cfset var cfhttp 		= '' /&gt;
		&lt;cfset var returnData 	= '' /&gt;
			&lt;!---
				Make the cfhttp request to obtain the image
				(appending the string '.qrcode' onto
				the shortened URL)
			---&gt;
			&lt;cfhttp url="#arguments.shortURL#.qrcode" /&gt;
			&lt;!--- Successful response? ---&gt;
			&lt;cfif cfhttp.StatusCode EQ '200 OK'&gt;
				&lt;!---
					Obtain the binary data using the
					toByteArray() method
				---&gt;
				&lt;cfset returnData =
						cfhttp.fileContent.toByteArray() /&gt;
			&lt;/cfif&gt;

	&lt;cfreturn returnData /&gt;

&lt;/cffunction&gt;
</pre>
<h2>How do I get it?</h2>
<p>You can download the revised version of the API wrapper from <a title="Download bit.ly ColdFusion CFC API Wrapper from riaforge.org" href="http://bitly.riaforge.org/" target="_blank">bitly.riaforge.org</a></p>
